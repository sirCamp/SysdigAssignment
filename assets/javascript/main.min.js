function dateParser(e){var a="";try{e=1e3*e;var i=new Date(e),s=i.getMonth()+1;a=(s.length>1?s:"0"+s)+"/"+i.getDate()+"/"+i.getFullYear()}catch(e){console.debug("Error during date parse")}finally{return a}}function drawModal(e){var a="#"+e.id,i="<h5><span class='material-icons'>bookmark</span> Name:</h5>"+e.name,s="<h5><span class='material-icons'>subject</span> Description:</h5>"+e.description,t="<h5><span class='material-icons'>list</span> Mac Address and Container:</h5>",l="<h5><span class='material-icons'>schedule</span> Times and Version:</h5>";l+="<ul>",l+="<li> Date: "+dateParser(e.timestamp)+"</li>",l+="<li> Created On: "+dateParser(e.modifiedOn)+"</li>",l+="<li> Modified On: "+dateParser(e.createdOn)+"</li>",l+="<li>Version: "+e.version+"<li>",l+="</ul>";var r="<h5><span class='material-icons'>label</span> Tags:</h5>";for(var n in e.tags)r+="<div class='chip'><span class='fa fa-circle' style='color:"+getColor(e.tags[n])+"'><span class='fa-span-margin black-text'>"+e.tags[n]+"</span></span></div>";var c=e.filter.toString().split("="),d=void 0!=c[1]?c[1].split(" and")[0]:"";t+="<ul><li>MAC: "+d+"</li><li>Container: "+c[2]+"</li></ul>",$("#event-name_id").html(a),$("#event-name").html(i),$("#event-description").html(s),$("#event-header_tags").html(r),$("#event-header_times_and_version").html(l),$("#event-filter").html(t),$("#modal").openModal()}function getColor(e){var a={falco_engine:"#ffcc80",docker:"#00c853",direct:"#0091ea",slack:"#7986cb",luca:"#c62828"};return a.hasOwnProperty(e.toLocaleLowerCase())?a[e.toLocaleLowerCase()]:("#"+Math.floor(16777215*Math.random()).toString(16)).toUpperCase()}$(document).ready(function(){var e=$("#events").DataTable({processing:!0,serverSide:!0,paging:!0,searching:{regex:!0},bServerSide:!1,bServerFilter:!1,order:[[0,"desc"]],ajax:{url:"https://app-staging.sysdigcloud.com/api/events",type:"GET",contentType:"application/json",dataFilter:function(e){var a=jQuery.parseJSON(e);return a.recordsTotal=a.total,a.recordsFiltered=a.total,a.data=a.events,JSON.stringify(a)},beforeSend:function(e){e.setRequestHeader("Authorization","Bearer 8aef9517-3070-4090-b55e-83296cee8cd1"),e.setRequestHeader("Content-Encoding","gzip, deflate, sdch")},error:function(e,a,i){console.log(e.responseText),console.log(a),console.log(i)}},sPaginationType:"full_numbers",bLengthChange:!0,bFilter:!0,columns:[{data:"id"},{data:"severity"},{data:"timestamp",render:function(e){return dateParser(e)}},{data:"name"},{data:"description",render:function(e){var a=e.substring(0,50);return a+"<a class='show_more tooltipped pointer' data-position='bottom' data-delay='50' data-tooltip='"+e+"'>...</a>"}},{data:"tags",render:function(e){var a="<ul>";for(var i in e)a+="<li><div class='chip'><span class='fa fa-circle' style='color:"+getColor(e[i])+"'><span class='fa-span-margin black-text'>"+e[i]+"</span></span></div></li>";return a+="<ul>"}},{target:-1,className:"dt-center",data:null,defaultContent:"<span class='material-icons tooltipped pointer' data-position='top' data-delay='50' data-tooltip='Click to get more details'>visibility</span>"},{data:"filter",render:function(e){return""!=e&&null!=e&&void 0!=e?e:""},visible:!1}],fnDrawCallback:function(){$(".tooltipped").tooltip({delay:50})},preDrawCallback:function(){$("select").addClass("browser-default"),$("select").material_select()},oLanguage:{sLengthMenu:"Show _MENU_",sProcessing:"<div class='preloader-wrapper big active'> <div class='spinner-layer spinner-blue'> <div class='circle-clipper left'> <div class='circle'></div> </div><div class='gap-patch'> <div class='circle'></div> </div><div class='circle-clipper right'> <div class='circle'></div> </div> </div> <div class='spinner-layer spinner-red'> <div class='circle-clipper left'> <div class='circle'></div> </div><div class='gap-patch'> <div class='circle'></div> </div><div class='circle-clipper right'> <div class='circle'></div> </div> </div> <div class='spinner-layer spinner-yellow'> <div class='circle-clipper left'> <div class='circle'></div> </div><div class='gap-patch'> <div class='circle'></div> </div><div class='circle-clipper right'> <div class='circle'></div> </div> </div> <div class='spinner-layer spinner-green'> <div class='circle-clipper left'> <div class='circle'></div> </div><div class='gap-patch'> <div class='circle'></div> </div><div class='circle-clipper right'> <div class='circle'></div> </div> </div> </div>"}});$("#events tbody").on("click",'span[class="material-icons tooltipped pointer"]',function(){var a=e.row($(this).parents("tr")).data();drawModal(a)}),$(".button-collapse").sideNav(),setInterval(function(){e.ajax.reload(),console.debug("REALOADING TABLE")},3e4)});